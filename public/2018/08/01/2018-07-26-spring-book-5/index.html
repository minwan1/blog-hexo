<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="WanBlog | 개발블로그">
    <meta name="keyword"  content="WanBlog | 개발블로그">
    <meta name="naver-site-verification" content="c80ae88a487472e88ec9170ad53578e81edad8b1"/>

    <meta property="og:type" content="article">
	  <meta property="og:title" content="Wan Blog">
	  <meta property="og:url" content="https://minwan1.github.io/img/ironman-draw.png">
	  <meta property="og:site_name" content="JavaScript/Java/Spring 개발 Blog">
	  <meta property="og:description" content="WanBlog | 개발블로그">
	  <meta property="og:image" content="https://minwan1.github.io/img/ironman-draw.png">
	  <meta property="og:updated_time" content="2017-11-26T10:28:42.000Z">
    
    <link rel="shortcut icon" href="/img/ironman-draw.png">
    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <title>
        
          온라인 서점 API 만들기로 살펴보는 Spring Boot OOP 5 - WanBlog | 개발블로그
        
    </title>

    <link rel="canonical" href="https://minwan1.github.io/2018/08/01/2018-07-26-spring-book-5/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/beantech.min.css">

    <!-- Pygments Highlight CSS -->
    <link rel="stylesheet" href="/css/highlight.css">

    <link rel="stylesheet" href="/css/widget.css">

    <link rel="stylesheet" href="/css/rocket.css">

    <link rel="stylesheet" href="/css/signature.css">

    <link rel="stylesheet" href="/css/toc.css">

    <!-- Custom Fonts -->
    <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">
	<!-- Modified by Yu-Hsuan Yen -->
<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        
            background-image: url('null')
            /*post*/
        
    }
    
    #signature{
        background-image: url('/img/signature/BeanTechSign-white.png');
    }
    
</style>

<header class="intro-header" >
    <!-- Signature -->
    <div id="signature">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                
                    <div class="post-heading">
                        <div class="tags">
                            
                              <a class="tag" href="/tags/#Spring" title="Spring">Spring</a>
                            
                              <a class="tag" href="/tags/#Java" title="Java">Java</a>
                            
                              <a class="tag" href="/tags/#온라인 서점 API 만들기로 살펴보는 Spring Boot OOP" title="온라인 서점 API 만들기로 살펴보는 Spring Boot OOP">온라인 서점 API 만들기로 살펴보는 Spring Boot OOP</a>
                            
                        </div>
                        <h1>온라인 서점 API 만들기로 살펴보는 Spring Boot OOP 5</h1>
                        <h2 class="subheading">회원가입 Service 만들기 - 응용영역 효율적으로 관리하기 (Part2)</h2>
                        <span class="meta">
                            Posted by Wan on
                            2018-08-01
                        </span>
                    </div>
                


                </div>
            </div>
        </div>
    </div>
</header>

	
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Wan Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>

                    

                        
                    

                        
                        <li>
                            <a href="/about/">About</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/archive/">Archives</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/tags/">Tags</a>
                        </li>
                        
                    
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Main Content -->
    <!-- Modify by Yu-Hsuan Yen -->

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <h1><span id="step-04-회원가입-service-만들기-응용영역-효율적으로-관리하기-part2">Step-04 회원가입 Service 만들기 : 응용영역 효율적으로 관리하기 - Part2</span></h1>
<h1><span id="응용-영역서비스">응용 영역(서비스)</span></h1>
<p>이번 단계는 <code>응용영역</code> 효율적으로 관리하기 - Part2 편으로 어떻게 하면 <code>응용영역</code>을 응집력 있고, 변경에 유연하고, 가독성 좋은 코드를 작성할지에 대해 알아볼 것입니다. 이장에서는 크게 아래와 같은 주제로 <code>응용영역</code>을 효율적으로 관리하는 방법에 대해 알아보겠습니다.</p>
<ul>
<li>책임</li>
<li>도메인 HelperService 만들기</li>
<li>DTO 사용하기</li>
<li>최종적인 회원가입 코드</li>
<li>Swagger를 통한 회원 가입 API CALL</li>
</ul>
<h1><span id="4-책임단일책임원칙">4. 책임(단일책임원칙)</span></h1>
<p>객체지향 설계를 하는 데 있어 기준을 잡아주는 원칙들이 있는데 이것을 SOLID 원칙이라고 합니다. 이중 먼저 단일 책임 원칙에 대한 내용을 얘기하려고 합니다. 단일 책임 원칙은 클래스는 하나의 책임을 가져야 한다는 내용입니다. 왜 클래스는 하나의 책임을 가져야 하는지에 대해 알아보겠습니다.</p>
<blockquote>
<p>좀 더 책임의 의미를 잘 전달하기 위해 처음 작성한 초난감 회원가입 코드를 기반으로 이 단락을 설명하겠습니다.</p>
</blockquote>
<p><strong>초난감 회원가입 서비스 코드</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span><span class="comment">// 옆에 어노테이션을 통해 아래에 멤버필드들이 자동으로 스프링 빈으로 등록됨.</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MemberSignUpService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> MemberRepository memberRepository;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> CodeVerificationService codeVerificationService;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Member <span class="title">signUp</span><span class="params">(<span class="keyword">final</span> MemberSignupRequest request)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> Member duplicator = memberRepository.findByEmail(request.getEmail());</span><br><span class="line">        <span class="keyword">if</span>(duplicator != <span class="keyword">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> MemberDuplicationException();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> CodeVerification CodeVerification = codeVerificationService.findByMobile(request.getMobile()); <span class="comment">// 유저가 있는지 여부를 확인할 수 있는데 인증코드 정보 객체</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(codeVerification.getAuthCode().equals(request.getAuthCode()))&#123;</span><br><span class="line">            Member member = request.toMember();<span class="comment">//성공</span></span><br><span class="line">            memberRepository.save(member);</span><br><span class="line">            <span class="keyword">return</span> member;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> MobileAuthenticationCodeFaildException();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2><span id="책임의-중요성">책임의 중요성</span></h2>
<p>먼저 책임이 뭔지 간단하게 알아보겠습니다. 클래스에서 책임의 기준은 요구 사항을 기반으로 누구에 의해 이 기능이 변경될 수 있는가를 생각하는 것입니다. 이 변경은 곧 <code>책임</code>을 의미하기 때문입니다. 각각의 책임들은 하나의 서비스 또는 클래스로 분리되어야 합니다. 그래야 변경에 유연하고 응집력 있는 코드를 가질 수 있기 때문입니다. 변경에 유연함은 버그가 없고 안정적인 코드가 되는것을 의미합니다.</p>
<p>사실 처음 회원가입 요구 사항 분석 단계에서 구현할 기능들을 나열하면서 각각의 책임들을 분리하는 게 좋습니다. 또 개인적으로는 이러한 이유 때문에 기능 구현에 앞서 구현할 기능들을 나열해 책임들을 정리하는편입니다.</p>
<blockquote>
<ul>
<li>처음에는 요구 사항에 나열된 기능들로 바로 책임을 분리하는 게 어려울 수 있습니다. 이럴 경우 Test 코드를 작성하면서 책임을 찾아내는 게 좋은 방법일 수 있습니다. (이과정은 다음 장에서 알아보도록 하겠습니다.)</li>
</ul>
</blockquote>
<p>다음은 왜 변경사항을 책임이라고 하고 또 분리되어야 하는지 예제를 통해 알아보겠습니다.</p>
<h2><span id="책임-찾기">책임 찾기</span></h2>
<p>먼저 회원가입 서비스에 어떤 <code>책임</code>들이 있는지 생각해보겠습니다. 위의 책임을 나누는 기준인 코드의 변경을 기반으로 책임을 찾아 보면 <code>회원가입</code>, <code>모바일 인증</code> 2가지 책임이 있을 수 있습니다.</p>
<p>초난감 회원가입 코드를 기반으로 보면 회원가입에 대한 로직이 변경이 일어난다면 모바일 인증이라는 코드와 결합되어 있어 변경하는 로직이 쉽지 않습니다. 반대로 인증 코드 부분을보면 인증코드 이외에도 만료시간 등을 체크해야 한다고 하면 전반적인 회원가입 소스 로직을 이해한 후에야 비로소 인증 코드에 대한 로직을 수정할 수 있습니다. 단지 회원가입이 아닌 인증코드 정책에 대한 소스 수정인데도 불구하고 회원가입 로직을 이해해야 하는 상황이 발생하게 됩니다.</p>
<blockquote>
<p>Email 중복 여부 체크 같은 경우에는 이메일 중복체크라는 기능이 변경이 일어날 수 없다고 생각하기 때문에 책임의 부분에서 뺏습니다. 하지만 이곳저곳 클래스에서 Email을 디비에서 검색 시 NULL 인지 검사하는 중복 소스가 발생할 수 있습니다. 이 부분은 밑에 단락에서 다루도록 하겠습니다.</p>
</blockquote>
<h2><span id="책임-분리">책임 분리</span></h2>
<p>만약 다른 클래스에서도 모바일 인증코드 기능을 구현해서 쓰고 있다면 사용하는 곳을 모두 변경해줘야 할 것입니다. 이렇듯 클래스 또는 서비스가 하나의 책임만을 다루지 않게 되면 변경에 엄청나게 취약하다는것을 알게되었습니다.</p>
<p>그렇기 때문에 회원가입과 인증 코드를 확인하는 소스는 다음과 같이 별도의 서비스로 분리해야 할 것입니다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// MemberSignUpService.class</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Member <span class="title">signUp</span><span class="params">(<span class="keyword">final</span> MemberSignupRequest request)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> Member duplicator = memberRepository.findByEmail(email);</span><br><span class="line">    <span class="keyword">if</span>(duplicator != <span class="keyword">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> MemberDuplicationException();</span><br><span class="line"></span><br><span class="line">    codeVerificationService.verify(request.getMobile(),request.getAuthCode());</span><br><span class="line">    Member member = request.toMember();<span class="comment">//성공</span></span><br><span class="line">    memberRepository.save(member);</span><br><span class="line">    <span class="keyword">return</span> member;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//CodeVerificationService.class</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">verify</span><span class="params">(<span class="keyword">final</span> String mobile, <span class="keyword">final</span> String authCode)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> CodeVerification codeVerification = codeVerificationRepository.findByMobile(mobile);</span><br><span class="line">    <span class="keyword">if</span>(!codeVerification.getAuthCode().equals(request.getAuthCod))) <span class="keyword">throw</span> <span class="keyword">new</span> MobileAuthenticationCodeFaildException();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>MemberSignUpService에서 인증 기능의 책임을 분리한 구조입니다. 이렇게 되면 회원가입 로직이 변경되거나 모바일 인증 로직이 변경된다고 해도 서로에 영향을 주지 않게 됩니다. 이제 인증 정책이 변경된다거나 회원가입 로직이 변경된다고 해도 서로의 책임만 다해준다면 둘한테 영향을 주지 않습니다.</p>
<p>사실 이것만으로도 기능면만 놓고 보면 코드의 응집력 + 코드 변경에 대한 유연성이 높아졌다고 할 수 있습니다. 물론 여기에 앞에 part1에서 다루었던 CodeVerification의 캡슐화된 verify() 함수를 사용한다면 더욱더 변경에 유연한 코드가 될 것입니다.</p>
<h2><span id="모바일-인증과-책임을-분리한-회원가입-메소드">모바일 인증과 책임을 분리한 회원가입 메소드</span></h2>
<p>아래는 리팩토링되어진 회원가입이 기능입니다. 이제 회원가입을 하기위해 아까와 같이 복잡합 인증코드의 로직을 이해할필요가없어졌습니다. 회원가입에 어떤 변화가 생긴다고 해도 회원가입에 대한 로직에만 집중하면 되니까 좀 더 과감하게 개발할 수 있게 되었습니다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> Member <span class="title">signUp</span><span class="params">(<span class="keyword">final</span> MemberSignupRequest request)</span></span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Member duplicator = memberRepository.findByEmail(email);</span><br><span class="line">    <span class="keyword">if</span>(duplicator != <span class="keyword">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> MemberDuplicationException();</span><br><span class="line">    codeVerificationService.verify(request.getMobile(), request.getAuthCode());</span><br><span class="line">    Member member = request.toMember();</span><br><span class="line">    memberRepository.save(member);</span><br><span class="line">    <span class="keyword">return</span> member;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1><span id="5도메인-helperservice-만들기">5.도메인 HelperService 만들기</span></h1>
<p>위에서 설명하지 않은 부분이 있습니다. 바로 Email 중복 체크를 하는 로직입니다. 여기에서 이메일 중복체크 여부는 사실 변경이 되거나 확장될 일이 거의 없습니다. 단순히 디비에서 해당 Email이 있는지 확인하는 로직이기 때문입니다.(물론 캐시 등을 적용할 수 도 있을 것입니다.) 사실 위에서 사용한 것처럼 아래와 같이 사용해도 크게 무방합니다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> Member duplicator = memberRepository.findByEmail(email);</span><br><span class="line"><span class="keyword">if</span>(duplicator != <span class="keyword">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> MemberDuplicationException();</span><br></pre></td></tr></table></figure>
<p>하지만 아무래도 Email 중복체크를 하기 위해서는 전방위적으로 유저를 조회하고 NULL 인지 검사하는 로직이 중복되어야 하는 문제가 있습니다</p>
<p>그래서 이렇게 변경이 없고 단순 조회이거나, 조회 후 NULL 체크하는 코드들은 해당 도메인에 helperService를 통해 관리하는 방법이 있습니다. 코드로 보면 아래와 같을 수 있습니다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//MemberHelperService</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> Member <span class="title">findById</span><span class="params">(<span class="keyword">final</span> <span class="keyword">long</span> id)</span></span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Member member = memberRepository.findOne(id);</span><br><span class="line">    <span class="keyword">if</span>(member == <span class="keyword">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> MemberNotFoundException();</span><br><span class="line">    <span class="keyword">return</span> member;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">verifyEmailIsDuplicated</span><span class="params">(<span class="keyword">final</span> Email email)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(isEmailDuplicated(email)) <span class="keyword">throw</span> <span class="keyword">new</span> MemberDuplicationException();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>위와 같이 HelperService를 사용하게 되면 아이디 중복체크 외에도 특정 필드로 객체를 조회한 후 NULL을 검사하는 반복 로직들을 해당 클래스를 통해 제거할 수 있습니다.</p>
<h2><span id="null을-지양하기">NULL을 지양하기</span></h2>
<p>위 클래스가 바로 3장에서 말했던 부분인 NULL을 지양하게 도와주는 역할을 하는 클래스입니다. 위 소스에서 findById 후 NULL이면 그냥 MemberNotFoundException()을 던지는 부분이 있습니다. 사실 디비로부터 NULL을 받은 후 NULL을 리턴해봤자 그 후에 어디에선가 NullPointerException이 발생합니다. 그렇게 되면 오히려 더 디버깅하기 힘들어집니다. 그렇기 때문에 차라리 조회하자마자 NULL 인지 검사를 하고 해당 조회 id를 조회 하고 바로 NullPointerException를 던지는 게 더 디버깅하기 효율적입니다. NULL은 최대한 주지도 말고 받지도 말아야합니다.</p>
<h1><span id="6-dto-사용하기">6. DTO 사용하기</span></h1>
<p>메서드에 전달할 파라미터가 많다면 dto를 사용하는 것을 추천드립니다. 그 이유는 표현 계층에서 말했던 이유와 비슷합니다.</p>
<ol>
<li>해당 메서드의 파라미터가 명세화가 됩니다.</li>
<li>추가적인 파라미터가 있다면 유연하게 대응할 수 있습니다.</li>
</ol>
<h1><span id="7-최종적인-회원가입-코드">7. 최종적인 회원가입 코드</span></h1>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span> <span class="comment">// 옆에 어노테이션을 통해 아래에 멤버필드들이 자동으로 스프링 빈으로 등록됨.</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MemberSignUpService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> MemberRepository memberRepository;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> MemberHelperService memberHelperService;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Member <span class="title">signUp</span><span class="params">(<span class="keyword">final</span> MemberSignupRequest request)</span></span>&#123;</span><br><span class="line">        memberHelperService.verifyEmailIsDuplicated(request.getEmail());</span><br><span class="line">        Member member = request.toMember();</span><br><span class="line">        memberRepository.save(member);</span><br><span class="line">        <span class="keyword">return</span> member;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>모바일 인증부분은 예제 설명을 위해 추가한 부분이라 코드에서 제거했습니다.</li>
</ul>
<p><strong>드디어 회원가입 API가 완성되었습니다. 위에 소스를 보시면 아시겠지만 응용서비스는 직접 로직을 수행하기보다는 도메인 모델에 로직 수행시키거나 각각의 모듈들을 연결하는 역할을 합니다. 그래야 서비스 영역은 단순한 구조를 가지게 되고, 가독성이 좋아지고, 그럼으로써 품질좋은 코드를 유지할 수 있게 해줍니다.</strong></p>
<h2><span id="swagger-를-통한-회원-가입-api-call">Swagger 를 통한 회원 가입 API CALL</span></h2>
<p>다음과 같이 Swagger 홈페이지를 통해 회원가입 API를 테스트 해보실 수 있습니다.</p>
<p><img src="https://github.com/minwan1/online-book-store/blob/master/img/swagger-test.gif" alt=""></p>
<p>다음은 Swagger Test URL입니다. - <a href="http://localhost:8080/swagger-ui.html" target="_blank" rel="noopener">http://localhost:8080/swagger-ui.html</a></p>
<p><strong>회원가입 Request Body</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"email"</span>: &#123;</span><br><span class="line">    <span class="attr">"value"</span>: <span class="string">"test@naver.com"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"name"</span>: &#123;</span><br><span class="line">    <span class="attr">"firstname"</span>: <span class="string">"test"</span>,</span><br><span class="line">    <span class="attr">"lastname"</span>: <span class="string">"test"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"password"</span>: &#123;</span><br><span class="line">    <span class="attr">"value"</span>: <span class="string">"12345"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>회원가입 Response Body</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"email"</span>: &#123;</span><br><span class="line">    <span class="attr">"value"</span>: <span class="string">"test@naver.com"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"name"</span>: &#123;</span><br><span class="line">    <span class="attr">"firstname"</span>: <span class="string">"test"</span>,</span><br><span class="line">    <span class="attr">"lastname"</span>: <span class="string">"test"</span>,</span><br><span class="line">    <span class="attr">"fullName"</span>: <span class="string">"test test"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1><span id="마치며">마치며</span></h1>
<p>회원가입 API가 드디어 만들어졌습니다. 사실 위에 초난강 회원가입 서비스처럼 생각 없이 의식의 흐름대로 코드를 작성한다면 30분 안에도 회원가입 기능을 구현할 수 있습니다. 하지만 그렇게 코드를 작성하게 되면 지금 당장은 돌아가겠지만 아마 후에 그 코드를 유지 보수하기 위해 300분 이상에 시간을 쓰고 있을 것입니다. 아주 간단한 기능 변경인데도 엄청난 리소스가 들어가게 되고, 간단한 확장인데도 코드를 손댈 수 가없어 꼼짝할 수 없는 상태가 됩니다.</p>
<p>이러한 일이 발생하지 않도록 코드 하나를 작성하더라도 변경, 확장을 생각하면서 코드를 만들어야 합니다. 그래야 기능이 변경되더라도 유연하게 변경하고, 확장해나갈 수 있기 때문입니다. 이러한 기준을 잡게 도와주는 원칙이 위에서 말한 SOLID 원칙이라는게 있습니다.</p>
<p>위에 예제 코드에서도 좀 부족한 부분이 있습니다. 확장 부분이나, codeVerificationService 클래스에 너무 의존하고 있는 모습들이 대표적인 예입니다. 이러한 문제들을 어떻게 풀어갈지에 대한 방법들은 주문 API를 만들면서 알아보도록 하겠습니다.</p>
<p>아마 다음 장에서는 주문 API를 만들기 전에 테스트 코드에 대한 내용을 다룰 것 같습니다. 긴 내용 읽어주셔서 감사합니다.(__)</p>

                

                <hr>
                <!-- Pager -->
                <ul class="pager">
                    
                        <li class="previous">
                            <a href="/2018/08/26/2018-08-26-spring-book-6/" data-toggle="tooltip" data-placement="top" title="온라인 서점 API 만들기로 살펴보는 Spring Boot OOP 6">&larr; Previous Post</a>
                        </li>
                    
                    
                        <li class="next">
                            <a href="/2018/08/01/2018-07-26-spring-book-4/" data-toggle="tooltip" data-placement="top" title="온라인 서점 API 만들기로 살펴보는 Spring Boot OOP 4">Next Post &rarr;</a>
                        </li>
                    
                </ul>

                <!-- duoshuo Share start -->
                
                <!-- 多说 Share end-->

                <!-- 多说评论框 start -->
                
                <!-- 多说评论框 end -->

                <!-- disqus comment start -->
                
                    <div class="comment">
                        <div id="disqus_thread" class="disqus-thread"></div>
                    </div>
                
                <!-- disqus comment end -->
            </div>
            
            <!-- Tabe of Content -->
            <!-- Table of Contents -->

    
      <aside id="sidebar">
        <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
          <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#undefined"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">Step-04 회원가입 Service 만들기 : 응용영역 효율적으로 관리하기 - Part2</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#undefined"><span class="toc-nav-number">2.</span> <span class="toc-nav-text">응용 영역(서비스)</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#undefined"><span class="toc-nav-number">3.</span> <span class="toc-nav-text">4. 책임(단일책임원칙)</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#undefined"><span class="toc-nav-number">3.1.</span> <span class="toc-nav-text">책임의 중요성</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#undefined"><span class="toc-nav-number">3.2.</span> <span class="toc-nav-text">책임 찾기</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#undefined"><span class="toc-nav-number">3.3.</span> <span class="toc-nav-text">책임 분리</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#undefined"><span class="toc-nav-number">3.4.</span> <span class="toc-nav-text">모바일 인증과 책임을 분리한 회원가입 메소드</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#undefined"><span class="toc-nav-number">4.</span> <span class="toc-nav-text">5.도메인 HelperService 만들기</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#undefined"><span class="toc-nav-number">4.1.</span> <span class="toc-nav-text">NULL을 지양하기</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#undefined"><span class="toc-nav-number">5.</span> <span class="toc-nav-text">6. DTO 사용하기</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#undefined"><span class="toc-nav-number">6.</span> <span class="toc-nav-text">7. 최종적인 회원가입 코드</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#undefined"><span class="toc-nav-number">6.1.</span> <span class="toc-nav-text">Swagger 를 통한 회원 가입 API CALL</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#undefined"><span class="toc-nav-number">7.</span> <span class="toc-nav-text">마치며</span></a></li></ol>
        
        </div>
      </aside>
    

                
            <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                       
                          <a class="tag" href="/tags/#Spring" title="Spring">Spring</a>
                        
                          <a class="tag" href="/tags/#Java" title="Java">Java</a>
                        
                          <a class="tag" href="/tags/#온라인 서점 API 만들기로 살펴보는 Spring Boot OOP" title="온라인 서점 API 만들기로 살펴보는 Spring Boot OOP">온라인 서점 API 만들기로 살펴보는 Spring Boot OOP</a>
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
                <hr>
                <h5>FRIENDS</h5>
                <ul class="list-inline">

                    
                </ul>
                
            </div>
        </div>
    </div>
</article>




<!-- disqus embedded js code start (one page only need to embed once) -->
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = "https-minwan1-github-io";
    var disqus_identifier = "https://minwan1.github.io/2018/08/01/2018-07-26-spring-book-5/";
    var disqus_url = "https://minwan1.github.io/2018/08/01/2018-07-26-spring-book-5/";

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<!-- disqus embedded js code start end -->




<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'left',
          icon: 'ℬ'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                
                
                

                

                

                
                    <li>
                        <a target="_blank"  href="https://github.com/Minwan1">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; Wan 2018 
                    <br>
                    Theme by <a href="http://huangxuan.me">Hux</a> 
                    <span style="display: inline-block; margin: 0 5px;">
                        <i class="fa fa-heart"></i>
                    </span> 
                    re-Ported by <a href="http://beantech.org">BeanTech</a> | 
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="91px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=YenYuHsuan&repo=hexo-theme-beantech&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js"></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/    
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("https://minwan1.github.io/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->


<script>
    // dynamic User by Hux
    var _gaId = 'UA-XXXXXXXX-X';
    var _gaDomain = 'yoursite';

    // Originial
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>




<!-- Baidu Tongji -->






	<a id="rocket" href="#top" class=""></a>
	<script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
    <script type="text/javascript" src="/js/toc.js?v=1.0.0" async=""></script>
<!-- Image to hack wechat -->
<img src="https://minwan1.github.io/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
